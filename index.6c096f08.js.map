{"mappings":"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","sources":["src/js/helpers.js","src/js/model.js","src/js/views/panelView.js","src/js/config.js","src/js/views/mapVIew.js","src/js/controller.js"],"sourcesContent":["// Utility functions\nexport function toMiles(meters) {\n  return meters * 0.000621371192;\n}\nexport function toMeters(miles) {\n  miles * 1609.344;\n}\n\nexport function miliToTime(mili) {\n  return new Date(mili).toISOString().slice(11, -5);\n} // Currently doesnt work for time > 24 hrs\n\nexport function round(number, precision) {\n  return Math.round(number * precision) / precision;\n}\n\n// Function to convert degree minute second coordinates to decimal degrees\nexport function ConvertDMSToDD(degrees, minutes, seconds, direction) {\n  // decimal = degrees + (minutes รท 60) + (seconds รท 3,600)\n  var dd = degrees + minutes / 60 + seconds / 3600;\n  if (direction == 'S' || direction == 'W') {\n    dd = dd * -1;\n  }\n  return dd;\n}\n","import { ConvertDMSToDD } from './helpers.js';\nexport const state = {\n  imageCoords: [],\n  uploadedImages: [],\n  currentLatLng: [],\n};\n\n// Extract image EXIF data in a promise\nexport function getExifData(file) {\n  return new Promise(function (resolve, reject) {\n    EXIF.getData(file, function () {\n      const {\n        DateTime,\n        GPSImgDirection,\n        GPSImgDirectionRef,\n        GPSLatitudeRef,\n        GPSLatitude,\n        GPSLongitudeRef,\n        GPSLongitude,\n        Make,\n        Model,\n      } = EXIF.getAllTags(this);\n      const latitude = ConvertDMSToDD(\n        GPSLatitude[0],\n        GPSLatitude[1],\n        GPSLatitude[2],\n        GPSLatitudeRef\n      );\n      const longitude = ConvertDMSToDD(\n        GPSLongitude[0],\n        GPSLongitude[1],\n        GPSLongitude[2],\n        GPSLongitudeRef\n      );\n      const imageData = {\n        DateTime,\n        GPSImgDirection,\n        GPSImgDirectionRef,\n        latitude,\n        longitude,\n        Make,\n        Model,\n      };\n      resolve(imageData);\n      reject(new Error('There was an error '));\n    });\n  });\n}\n\nexport async function getRoute(transportMode) {\n  try {\n    const pointArray = state.imageCoords.map(({ lat, lng }) => [+lng, +lat]);\n    const query = new URLSearchParams({\n      key: 'db56c0cf-613e-456d-baea-46650066da62', // remove from github\n    }).toString();\n    const res = await fetch(`https://graphhopper.com/api/1/route?${query}`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        profile: transportMode,\n        points: pointArray,\n        points_encoded: false,\n      }),\n    });\n    const data = await res.json();\n    if (!res.ok) throw new Error(`${data.message}`);\n    return data;\n  } catch (error) {\n    console.error(error);\n    return error;\n  }\n}\n\nexport const getPosition = function () {\n  return new Promise(function (resolve, reject) {\n    navigator.geolocation.getCurrentPosition(resolve, reject);\n  });\n};\n","import { miliToTime, round, toMiles } from '../helpers';\nclass PanelView {\n  _parentElement = document.querySelector('#upload-form');\n  _input = document.querySelector('#fileInput');\n  _submitBtn = document.querySelector('#submit-route-btn');\n  _clearBtn = document.querySelector('#clear-btn');\n  _userLocationInput = document.querySelector('#user-location');\n  preview = document.querySelector('#preview');\n  form = document.querySelector('form');\n  routePreviewCard;\n  locationPreviewCard;\n\n  addHandlerFileInput(handler) {\n    this._input.addEventListener('change', async function (e) {\n      const fileList = this.files;\n      if (!fileList.length) return;\n      handler(fileList);\n      this.value = null;\n    });\n  }\n  addHandlerRemoveImage(handler) {\n    this.preview.addEventListener('click', function (e) {\n      const removeBtn = e.target.closest('.preview__card--remove-btn');\n      if (!removeBtn) return;\n      e.stopImmediatePropagation();\n      const imgIndex = e.target.closest('.preview__card').dataset.photoIndex;\n      handler(imgIndex);\n    }, true);\n  }\n  addHandlerPreviewClick(handler) {\n    this.preview.addEventListener('click', function (e) {\n      e.preventDefault();\n      const imgIndex = e.target.closest('.preview__card').dataset.photoIndex;\n      if (!imgIndex) return;\n      handler(imgIndex);\n    });\n  }\n  addHandlerLocationPreviewClick(handler){\n    this.preview.addEventListener('click', function(e) {\n      e.preventDefault();\n      const locationPreviewCard = e.target.closest('.location__card');\n      if(!locationPreviewCard) return;\n      handler();\n    })\n  }\n  addHandlerRemoveCurrentLocation(handler){\n    this.preview.addEventListener('click', function (e) {\n      const removeBtn = e.target.closest('.location__card--remove-btn');\n      if (!removeBtn) return;\n      e.stopImmediatePropagation();\n      handler();\n      const _userLocationInput = document.querySelector('#user-location');\n      _userLocationInput.checked = false; // Why must this be re-declared rather than using declaration from above?\n    });\n  }\n  addHandlerSubmit(handler) {\n    this.form.addEventListener('submit', async (e) => {\n      e.preventDefault();\n      const formData = new FormData(this.form);\n      const transportMode = formData.get('transport-mode');\n      handler(transportMode);\n    });\n  }\n  addHandlerClear(handler) {\n    this._clearBtn.addEventListener('click', (e) => {\n      handler();\n      // Remove all image previews\n      this.preview.replaceChildren();\n\n      // reset to default coords/world view\n      this.form.reset();\n      this._submitBtn.disabled = true;\n    });\n  }\n  addHandlerUserLocation(handler) {\n    this._userLocationInput.addEventListener('change', (e) => handler(e));\n  }\n  // Function to print image, info and coords to preview area\n  renderPreviewCard(file, exifData, i) {\n    // Create preview card element\n    const previewCard = document.createElement('div');\n    previewCard.classList.add('preview__card');\n    previewCard.dataset.photoIndex = i;\n    const previewCardHeader = document.createElement('div');\n    previewCardHeader.classList.add('preview__card--header');\n    const previewCardText = document.createElement('div');\n    previewCardText.classList.add('preview__card--text');\n\n    // Create remove button\n    const previewCardRemoveBtn = document.createElement('button');\n    previewCardRemoveBtn.innerText = 'X';\n    previewCardRemoveBtn.setAttribute('title', 'Remove this item');\n    previewCardRemoveBtn.classList.add('preview__card--remove-btn');\n\n    // Create card image\n    const previewImage = document.createElement('img');\n    previewImage.classList.add('preview__image');\n    previewImage.src = URL.createObjectURL(file);\n\n    // Convert image date from exif data format to javascript format\n    const [year, month, day, hours, minutes, seconds] =\n      exifData.DateTime.split(/[: ]/);\n    const dateObject = new Date(year, month - 1, day, hours, minutes, seconds);\n\n    previewCardText.innerHTML = `\n      <h4>${file.name}</h4>\n      <dl>\n        <dt>Date:</dt><dd>${dateObject.toLocaleDateString()}</dd>\n        <dt>Time:</dt><dd>${dateObject.toLocaleTimeString([], {\n          hour: '2-digit',\n          minute: '2-digit',\n        })}</dd>\n        <dt>lat, lng: </dt><dd>${exifData.latitude.toFixed(\n          2\n        )}, ${exifData.longitude.toFixed(2)}</dd>\n        <dt>Camera:</dd><dd> ${exifData.Make} ${exifData.Model}</dd>\n      </dl>\n    `;\n    // Append card items\n    previewCardHeader.appendChild(previewImage);\n    previewCard.appendChild(previewCardHeader);\n    previewCard.appendChild(previewCardRemoveBtn);\n    previewCard.appendChild(previewCardText);\n    this.preview.insertAdjacentElement('afterbegin', previewCard);\n  }\n  renderRoutePreviewCard(routeData) {\n    const routeTime = miliToTime(routeData.paths[0].time);\n    const routeDistance = routeData.paths[0].distance;\n    const routePreviewEl = document.getElementsByClassName(\n      'preview__card--route'\n    );\n    if (!routePreviewEl.length) {\n      this.routePreviewCard = document.createElement('div');\n      this.routePreviewCard.classList.add(\n        'preview__card--text',\n        'preview__card--route',\n        'preview__card'\n      );\n      this.preview.insertAdjacentElement('beforebegin', this.routePreviewCard);\n    }\n    this.routePreviewCard.innerHTML = `\n    <h4>Route</h4>\n    <span><h4>${routeTime}</h4>\n    <p>${round(toMiles(routeDistance), 100)} mi</p>\n    </span>\n    `;\n  }\n  renderLocationCard(location) {\n    if (!location) return;\n    const locationCardEl = document.getElementsByClassName('location__card');\n    if (!locationCardEl.length) {\n      this.locationPreviewCard = document.createElement('div');\n      this.locationPreviewCard.classList.add(\n        'preview__card',\n        'preview__card--text',\n        'location__card'\n      );\n\n      this.preview.insertAdjacentElement(\n        'afterbegin',\n        this.locationPreviewCard\n      );\n    }\n    this.locationPreviewCard.innerHTML = `\n      <h4>Current Location</h4>\n      <span><h4>${location}</h4>\n      </span>\n    `;\n    // Create remove button\n    const previewCardRemoveBtn = document.createElement('button');\n    previewCardRemoveBtn.innerText = 'X';\n    previewCardRemoveBtn.setAttribute('title', 'Remove current location');\n    previewCardRemoveBtn.classList.add('location__card--remove-btn');\n    this.locationPreviewCard.appendChild(previewCardRemoveBtn);\n  }\n}\n\nexport default new PanelView();\n","export const DEFAULT_COORDS = [-77.041493, 38.930859];","import { DEFAULT_COORDS } from '../config';\nimport { miliToTime } from '../helpers';\nconst { MAPBOX_TOKEN } = process.env\nclass MapView {\n  // Leaflet objects and initialization\n  constructor() {\n    this.map = L.map('map').setView([DEFAULT_COORDS[1], DEFAULT_COORDS[0]], 5);\n    this.tiles = L.tileLayer(\n      `https://api.mapbox.com/styles/v1/lanesgood/clhsi5wdt00yk01pffukxf1s4/tiles/{z}/{x}/{y}?access_token=${MAPBOX_TOKEN}`,\n      {\n        minZoom: 0,\n        maxZoom: 22,\n      }\n    );\n    this.routeLine = L.polyline([]); // Set empty routeline to allow later clearing. Will likely later change to array of features to permit multiple lines\n    this.photoMarkers = L.layerGroup();\n    this.currentPositionMarker = L.marker();\n  }\n  render() {\n    this.tiles.addTo(this.map);\n    this.photoMarkers.addTo(this.map);\n  }\n  renderPhotoMarker(latitude, longitude, file, i) {\n    const imageURL = URL.createObjectURL(file);\n    const photoPopup = L.popup({\n      autoClose: false,\n    }).setContent(`<img class='marker-photo' src='${imageURL}' />`);\n    const photoMarker = L.marker([latitude, longitude]);\n    photoMarker.photoIndex = i;\n    this.photoMarkers.addLayer(photoMarker);\n    photoMarker.bindPopup(photoPopup).openPopup();\n  }\n\n  renderRouteLine(routeData) {\n    const routeCoords = routeData.paths[0].points.coordinates.map((coords) => [\n      coords[1],\n      coords[0],\n    ]);\n    const routeTime = miliToTime(routeData.paths[0].time);\n    this.routeLine.setLatLngs(routeCoords).addTo(this.map);\n    this.routeLine.bindPopup(`${routeTime}`).openPopup();\n  }\n  clearRouteLine(){\n    this.routeLine = L.polyline([]);\n  }\n}\nexport default new MapView();\n","import * as model from './model.js';\nimport panelView from './views/panelView.js';\nimport mapView from './views/mapView.js';\nimport { DEFAULT_COORDS } from './config.js';\n\nif (module.hot) {\n  module.hot.accept();\n}\nconst controlAddFiles = async function (fileList) {\n  panelView._submitBtn.disabled = false;\n  Array.from(fileList).forEach(async (file, i) => {\n    if (\n      !model.state.uploadedImages.some((img) => img.file.name === file.name)\n    ) {\n      // only add photos if they haven't been added yet\n      model.state.uploadedImages.push({ file, photoIndex: i });\n      try {\n        const exifData = await model.getExifData(file);\n        const { latitude, longitude } = exifData;\n        model.state.imageCoords.push({\n          photoIndex: i,\n          lat: latitude,\n          lng: longitude,\n        });\n\n        // Create a photo marker\n        mapView.renderPhotoMarker(latitude, longitude, file, i);\n        panelView.renderPreviewCard(file, exifData, i);\n        mapView.map.flyToBounds(model.state.imageCoords);\n      } catch (e) {\n        console.error(e);\n        alert('Could not extract location data for this image');\n      }\n    } else {\n      alert(`${file.name} is already in the destination list`);\n    }\n  });\n  mapView.clearRouteLine();\n};\n\nconst controlPreviewClick = function (i) {\n  const img = model.state.imageCoords.find((img) => img.photoIndex === +i);\n  mapView.map.flyTo([img.lat, img.lng], 15);\n  mapView.photoMarkers.eachLayer((layer) => {\n    if (layer.photoIndex === +i) {\n      layer.openPopup();\n    }\n  });\n};\n\nconst controlRemoveImage = function (i) {\n  mapView.photoMarkers.eachLayer((layer) => {\n    if (layer.photoIndex === +i) {\n      mapView.map.removeLayer(layer);\n    }\n  });\n  panelView.preview.removeChild(\n    panelView.preview.querySelector(`[data-photo-index=\"${i}\"]`)\n  );\n  model.state.uploadedImages = model.state.uploadedImages.filter(\n    (img) => img.photoIndex !== +i\n  );\n  model.state.imageCoords = model.state.imageCoords.filter(\n    (img) => img.photoIndex !== +i\n  );\n  mapView.clearRouteLine();\n};\n\nconst controlUserLocation = async function (e) {\n  if (e.target.checked) {\n    try {\n      const {\n        coords: { latitude, longitude },\n      } = await model.getPosition();\n      model.state.currentLatLng.push(latitude, longitude);\n      // Add current location from coordinates array\n      model.state.imageCoords.push({\n        photoIndex: 1000,\n        lat: latitude,\n        lng: longitude,\n      });\n      // Add current location marker\n      mapView.currentPositionMarker.setLatLng(model.state.currentLatLng);\n      mapView.currentPositionMarker.bindPopup('Current location');\n      mapView.photoMarkers.addLayer(mapView.currentPositionMarker);\n\n      // Add current location preview card\n      panelView.renderLocationCard(model.state.currentLatLng);\n      mapView.currentPositionMarker.openPopup();\n      mapView.map.flyToBounds(model.state.imageCoords);\n    } catch (e) {\n      console.error(e);\n      alert('User location not available'); // Replace with toast\n    }\n  } else if (!e.target.checked) {\n    // Remove current location marker\n    if (mapView.map.hasLayer(mapView.currentPositionMarker)) {\n      mapView.map.removeLayer(mapView.currentPositionMarker);\n    }\n    // Remove current location from coords array\n    model.state.imageCoords = model.state.imageCoords.filter(\n      (imgCoord) =>\n        !(\n          imgCoord.lat === model.state.currentLatLng[0] &&\n          imgCoord.lng === model.state.currentLatLng[1]\n        )\n    );\n    // Remove current lat long\n    model.state.currentLatLng.length = 0;\n\n    // Set map view based on existing images\n    if (model.state.imageCoords.length > 0) {\n      mapView.map.flyToBounds(model.state.imageCoords);\n    } else {\n      mapView.map.flyTo([DEFAULT_COORDS[1], DEFAULT_COORDS[0]], 10);\n    }\n    // Remove location preview card\n    panelView.preview.removeChild(panelView.locationPreviewCard);\n    // Remove current position marker\n    mapView.photoMarkers.removeLayer(mapView.currentPositionMarker);\n    return model.state.imageCoords;\n  }\n};\nconst controlLocationPreviewClick = function () {\n  mapView.map.flyTo(\n    [model.state.currentLatLng[0], model.state.currentLatLng[1]],\n    15\n  );\n};\n\nconst controlRemoveLocationPreview = function () {\n  // Remove current location from coords array\n  model.state.imageCoords = model.state.imageCoords.filter(\n    (imgCoord) =>\n      !(\n        imgCoord.lat === model.state.currentLatLng[0] &&\n        imgCoord.lng === model.state.currentLatLng[1]\n      )\n  );\n  // Remove current lat long\n  model.state.currentLatLng.length = 0;\n  // Remove location preview card\n  panelView.preview.removeChild(panelView.locationPreviewCard);\n  // Remove map marker for current location\n  if (mapView.map.hasLayer(mapView.currentPositionMarker)) {\n    mapView.map.removeLayer(mapView.currentPositionMarker);\n  }\n};\n\nconst controlSubmit = async function (transportMode) {\n  const routeData = await model.getRoute(transportMode);\n  mapView.map.flyToBounds(model.state.imageCoords);\n  mapView.renderRouteLine(routeData);\n  panelView.renderRoutePreviewCard(routeData);\n};\n\nconst controlClear = function () {\n  // Remove all images\n  model.state.uploadedImages.length = 0;\n  model.state.imageCoords.length = 0;\n  // remove all photo markers\n  mapView.photoMarkers.clearLayers();\n  // remove route from map\n  mapView.routeLine.remove();\n  // Reset map view\n  mapView.map.flyTo([DEFAULT_COORDS[1], DEFAULT_COORDS[0]], 10);\n};\n\nconst init = function () {\n  console.log('Snappy trails is up and running. Reticulating splines');\n\n  mapView.render();\n  panelView.addHandlerUserLocation(controlUserLocation);\n  panelView.addHandlerFileInput(controlAddFiles);\n  panelView.addHandlerPreviewClick(controlPreviewClick);\n  panelView.addHandlerLocationPreviewClick(controlLocationPreviewClick);\n  panelView.addHandlerRemoveCurrentLocation(controlRemoveLocationPreview);\n  panelView.addHandlerRemoveImage(controlRemoveImage);\n  panelView.addHandlerSubmit(controlSubmit);\n  panelView.addHandlerClear(controlClear);\n};\ninit();\n"],"names":["$bd02c871d9c5ba8e$export$fd49f38c4a455c6d","mili","Date","toISOString","slice","$bd02c871d9c5ba8e$export$3715616f3d4d8e41","degrees","minutes","seconds","direction","dd","$0f1d4402dffacf5b$export$ca000e230c0caa3e","imageCoords","uploadedImages","currentLatLng","$4bc90fbbdfa17099$export$2e2bcd8739ae039","_parentElement","document","querySelector","_input","_submitBtn","_clearBtn","_userLocationInput","preview","form","routePreviewCard","locationPreviewCard","addHandlerFileInput","handler","this","addEventListener","async","e","fileList","files","length","value","addHandlerRemoveImage","target","closest","stopImmediatePropagation","imgIndex","dataset","photoIndex","addHandlerPreviewClick","preventDefault","addHandlerLocationPreviewClick","addHandlerRemoveCurrentLocation","checked","addHandlerSubmit","transportMode","FormData","get","addHandlerClear","replaceChildren","reset","disabled","addHandlerUserLocation","renderPreviewCard","file","exifData","i","previewCard","createElement","classList","add","previewCardHeader","previewCardText","previewCardRemoveBtn","innerText","setAttribute","previewImage","src","URL","createObjectURL","year","month","day","hours","DateTime","split","dateObject","innerHTML","name","toLocaleDateString","toLocaleTimeString","hour","minute","latitude","toFixed","longitude","Make","Model","appendChild","insertAdjacentElement","renderRoutePreviewCard","routeData","routeTime","paths","time","routeDistance","distance","number","precision","meters","getElementsByClassName","Math","round","renderLocationCard","location","$ba30e20475feac5a$export$2caadec3201a577","$de3795e4974290a6$export$2e2bcd8739ae039","constructor","map","L","setView","tiles","tileLayer","minZoom","maxZoom","routeLine","polyline","photoMarkers","layerGroup","currentPositionMarker","marker","render","addTo","renderPhotoMarker","imageURL","photoPopup","popup","autoClose","setContent","photoMarker","addLayer","bindPopup","openPopup","renderRouteLine","routeCoords","points","coordinates","coords","setLatLngs","clearRouteLine","$f50bd1f2915ed0f2$var$controlAddFiles","Array","from","forEach","some","img","alert","push","Promise","resolve","reject","EXIF","getData","GPSImgDirection","GPSImgDirectionRef","GPSLatitudeRef","GPSLatitude","GPSLongitudeRef","GPSLongitude","getAllTags","Error","$0f1d4402dffacf5b$export$dd3a48f74d5a1199","lat","lng","flyToBounds","console","error","$f50bd1f2915ed0f2$var$controlPreviewClick","find","flyTo","eachLayer","layer","$f50bd1f2915ed0f2$var$controlRemoveImage","removeLayer","removeChild","filter","$f50bd1f2915ed0f2$var$controlUserLocation","navigator","geolocation","getCurrentPosition","setLatLng","hasLayer","imgCoord","$f50bd1f2915ed0f2$var$controlLocationPreviewClick","$f50bd1f2915ed0f2$var$controlRemoveLocationPreview","$f50bd1f2915ed0f2$var$controlSubmit","pointArray","query","URLSearchParams","key","toString","res","fetch","method","headers","body","JSON","stringify","profile","points_encoded","data","json","ok","message","$0f1d4402dffacf5b$export$da6d2f7032b7150b","$f50bd1f2915ed0f2$var$controlClear","clearLayers","remove","log"],"version":3,"file":"index.6c096f08.js.map"}